---
title: "Python SuperLearner analysis"
format:
  html:
    self-contained: true
---

```{python}
import numpy as np
from sklearn.datasets import make_classification
from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression
from mysuperlearner import ExtendedSuperLearner

# Generate data
X, y = make_classification(n_samples=500, n_features=10, random_state=123)

# Define learners
learners = [
    ('rf', RandomForestClassifier(n_estimators=50, random_state=1)),
    ('log', LogisticRegression(max_iter=200, random_state=1))
]

# Fit SuperLearner using explicit API
sl = ExtendedSuperLearner(method='nnloglik', folds=5, random_state=1)
sl.fit_explicit(X, y, learners)

# Get diagnostics
diag = sl.get_diagnostics()
print(f'Method: {diag["method"]}')
print(f'Base learners: {diag["base_learner_names"]}')
print(f'Meta-weights: {diag["meta_weights"]}')
print('Done')
```
